function t(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var e=function(e,n,o={}){const r={start:"[",end:"]",path:"[a-z0-9_$][\\.a-z0-9_]*",...o},l={};let i={},a=!1;const s=new RegExp(`${t(r.start)}\\s*(!?)\\s*(${r.path})\\s*${t(r.end)}`,"gi");function c(t,e,...n){const o=l[t];if(!o)return e;for(const[t]of o){const o=t(e,...n);void 0!==e&&void 0!==o&&(e=o),null==o&&(e="")}return e}function f(t,e){if("string"==typeof t){if(void 0===e)return i[t]||"";!1===e?delete i[t]:i[t]=e}else"object"==typeof t&&null!==t?Object.keys(t).forEach((e=>{f(e,t[e])})):"boolean"!=typeof t||t||(i={});return i}function u(t,e){if(a||(a=!0,c("init")),!(t=c("templateBefore",t)).includes(r.start)){const e=f(t);e&&(t=e)}return(t=c("template",t))&&void 0!==e&&(t=function(t,e){let n;for(;null!==(n=s.exec(t));){const o=n[2];let l=c("token",o,e,t);const i=n.index,a=s.lastIndex,f=t.slice(0,i);let u=t.slice(a);if("function"==typeof l&&(l=l.call(e,e)),"boolean"!=typeof l&&"object"!=typeof l)t=f+l+u;else{let e="";const i=`${r.start}/${o}${r.end}`,a=u.indexOf(i);if(!(a>=0))throw new Error(`Potion: '${o}' not closed`);{const r=u.slice(0,a);if(u=u.slice(a+i.length),"boolean"==typeof l)e=l^"!"!==n[1]?"":r;else{for(const t in l)if(l.hasOwnProperty(t)){s.lastIndex=0;const n=c("loopData",{_key:t,_value:l[t],...l[t]},r,o);e+=c("loop",create(r,n),o,n)}e=c("loopEnd",e,o,l)}t=f+e+u}}s.lastIndex=0}return t}(t,e)),c("templateAfter",t)}if(function(t,e,n=0){if("function"!=typeof e)throw new TypeError("Invalid arguments: 'name' must be a string and 'fn' must be a function.");l[t]=l[t]||[],l[t].push([e,n]),l[t].sort(((t,e)=>t[1]-e[1]))}("token",((t,e,n)=>{const o=t.split(".");let r=e;for(let t=0;t<o.length;t++){if(!Object.prototype.hasOwnProperty.call(r,o[t]))throw new Error(`Potion: '${o[t]}' not found${t?` in ${n}`:""}`);if(r=r[o[t]],t===o.length-1)return r}})),window&&window.document){const t=r.type||"template/potion",e=r.attr||"data-name",n=document.querySelectorAll(`template[type='${t}']`);u.renderFromDOM=function(){const t={};return n.forEach(((n,o)=>{const r=n.getAttribute(e)||`potion-${o}`;t[r]=n.innerHTML})),f(t),t},u.renderFromDOM(),u.render=function(t,e,n={}){const o=document.querySelector(`template[data-name='${t}']`);if(!o)throw new Error(`Potion: template with name '${t}' not found`);return function(t,e,n={}){if(!(t instanceof HTMLTemplateElement))return void console.error("L'élément fourni n'est pas un `<template>`.");const o=n.tag||"div",r=document.createElement(o);return r.innerHTML=e,[...t.attributes].forEach((t=>{"type"!==t.name&&r.setAttribute(t.name,t.value)})),n.class&&r.classList.add(...n.class.split(" ")),t.parentNode.replaceChild(r,t),r}(o,u(t,e),n)}}return u}();export{e as default};
